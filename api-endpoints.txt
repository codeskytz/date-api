Overview
This document defines the complete API map and master database schema for a scalable, load-balanced social media platform built using Laravel, Redis, OAuth, and modern backend architecture.
API Base Configuration
Base URL: /api/v1
Authentication: Bearer Token (JWT or Sanctum)
All endpoints are stateless.
Authentication & OAuth APIs
POST /auth/register
POST /auth/login
GET /oauth/{provider}/redirect
GET /oauth/{provider}/callback
User & Account APIs
GET /me
GET /users/{username}
PUT /me
GET /account/privacy
POST /account/privacy
Verification APIs
POST /verification/request
GET /verification/status
DELETE /verification/cancel
GET /admin/verification/pending
GET /admin/verification/approved
GET /admin/verification/rejected
GET /admin/verification/all
GET /admin/verification/{id}
POST /admin/verification/{id}/approve
POST /admin/verification/{id}/reject
Admin approval and rejection endpoints
Post APIs
POST /posts
GET /feed
POST /posts/{id}/like
POST /posts/{id}/comments
POST /posts/{id}/save
Story APIs
POST /stories
GET /stories/feed
POST /stories/{id}/view
Follow & Matching APIs
POST /users/{id}/follow
DELETE /users/{id}/follow
GET /matches
Chat APIs
POST /messages
GET /messages/{user_id}
Notification APIs
GET /notifications
GET /notifications/settings
POST /notifications/settings
Safety & Moderation APIs
POST /users/{id}/block
POST /reports/post|user|story
Analytics APIs
GET /posts/{id}/insights
GET /analytics/profile
Admin APIs
POST /api/admin/auth/login
GET /api/admin/dashboard
GET /api/admin/users
POST /api/admin/users/{id}/ban
GET /api/admin/verification/pending
GET /api/admin/verification/approved
GET /api/admin/verification/rejected
GET /api/admin/verification/all
GET /api/admin/verification/{id}
POST /api/admin/verification/{id}/approve
POST /api/admin/verification/{id}/reject
POST /api/admin/verification/{id}/approve
POST /api/admin/verification/{id}/reject
System APIs
GET /health
Database Schema

POST /api/auth/register

Request
{
  "name": "John Doe",
  "username": "johndoe",
  "email": "john@example.com",
  "password": "StrongPassword123",
  "password_confirmation": "StrongPassword123"
}

Response (201)
{
  "status": "success",
  "message": "Account created successfully",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

2ï¸âƒ£ Login

POST /api/auth/login

Request
{
  "email": "john@example.com",
  "password": "StrongPassword123"
}

Response (200)
{
  "status": "success",
  "token": "jwt_access_token_here",
  "user": {
    "id": 1,
    "username": "johndoe"
  }
}

ğŸ‘¤ USER PROFILE APIs
3ï¸âƒ£ Get My Profile

GET /api/me

Headers

Authorization: Bearer jwt_access_token

Response
{
  "id": 1,
  "name": "John Doe",
  "username": "johndoe",
  "avatar": "https://cdn.example.com/avatar.jpg",
  "followers": 120,
  "following": 80
}

4ï¸âƒ£ View User Profile

GET /api/users/{username}

Response
{
  "username": "johndoe",
  "bio": "Laravel developer",
  "followers": 120,
  "posts": 34,
  "is_following": true
}

ğŸ“ POSTS APIs
5ï¸âƒ£ Create Post

POST /api/posts

Request
{
  "content": "Hello world ğŸŒ",
  "media": ["https://cdn.example.com/photo.jpg"]
}

Response (201)
{
  "post_id": 101,
  "message": "Post created successfully"
}

6ï¸âƒ£ Get Feed (Cached)

GET /api/feed?page=1

Response
{
  "page": 1,
  "data": [
    {
      "post_id": 101,
      "author": "johndoe",
      "content": "Hello world ğŸŒ",
      "likes": 10,
      "comments": 2,
      "created_at": "2025-12-29T10:20:00Z"
    }
  ]
}


ğŸ”¥ This endpoint is usually Redis cached

â¤ï¸ INTERACTIONS APIs
7ï¸âƒ£ Like / Unlike Post

POST /api/posts/{id}/like

Response
{
  "liked": true,
  "total_likes": 11
}

8ï¸âƒ£ Comment on Post

POST /api/posts/{id}/comments

Request
{
  "comment": "Nice post ğŸ”¥"
}

Response
{
  "comment_id": 501,
  "message": "Comment added"
}

ğŸ¤ FOLLOW SYSTEM APIs
9ï¸âƒ£ Follow User

POST /api/users/{id}/follow

Response
{
  "following": true
}

ğŸ”” NOTIFICATIONS APIs
ğŸ”Ÿ Get Notifications

GET /api/notifications

Response
{
  "data": [
    {
      "type": "like",
      "from": "janedoe",
      "post_id": 101,
      "created_at": "2025-12-29T12:00:00Z"
    }
  ]
}

ğŸ’¬ CHAT APIs (REST + WebSocket)
1ï¸âƒ£1ï¸âƒ£ Send Message

POST /api/messages

Request
{
  "to_user_id": 2,
  "message": "Hey, how are you?"
}

Response
{
  "message_id": 7001,
  "status": "sent"
}

1ï¸âƒ£2ï¸âƒ£ Fetch Messages

GET /api/messages/{user_id}

Response
{
  "messages": [
    {
      "from": "johndoe",
      "message": "Hey, how are you?",
      "timestamp": "2025-12-29T12:05:00Z"
    }
  ]
}

ğŸ” SEARCH APIs
1ï¸âƒ£3ï¸âƒ£ Search Users & Posts

GET /api/search?q=laravel

Response
{
  "users": ["johndoe", "laravelguru"],
  "posts": [
    {
      "post_id": 301,
      "content": "Laravel scaling tips"
    }
  ]
}

ğŸ©º SYSTEM APIs
1ï¸âƒ£4ï¸âƒ£ Health Check (Load Balancer)

GET /health

Response
{
  "status": "ok",
  "server_time": "2025-12-29T12:10:00Z"
}


ğŸ”¥ Used by load balancer to detect failures

ğŸ§  IMPORTANT DESIGN NOTES

All APIs are stateless

Auth via JWT / Sanctum

Sessions stored in Redis

Media stored in S3 / R2

Works perfectly with multiple Laravel servers

Load balancer can route any request to any server ğŸ˜

Want next? ğŸš€

I can:

Map these APIs to Laravel Controllers

Generate routes/api.php

Design DB schema

Create Swagger/OpenAPI docs

Export everything into an official .docx

Just say whatâ€™s next ğŸ”¥ğŸ˜

mmmmh how about admin endpoints  for management of social  media also some crucial endpoints like story posting   mtching for the  followed  each oother profiles , also   how about 0auth endpoints how can i handle them in api

Great direction ğŸ˜ğŸ”¥
Below is a clean, production-grade API design covering ADMIN endpoints, Stories, Mutual-follow matching, and OAuth handling in APIs (Laravel-friendly).
Everything is load-balancer safe, stateless, and scalable âš¡

ğŸ›¡ï¸ ADMIN API ENDPOINTS (MANAGEMENT)

Admin APIs are separate, protected by:

Admin role

Admin middleware

Strong rate-limits

Optional IP allow-list

Base prefix:

/api/admin/*

1ï¸âƒ£ Admin Login

POST /api/admin/auth/login

{
  "email": "admin@platform.com",
  "password": "VeryStrongPassword"
}


Response

{
  "token": "admin_jwt_token",
  "role": "admin"
}

2ï¸âƒ£ Dashboard Stats

GET /api/admin/dashboard

{
  "users": 12450,
  "posts": 89320,
  "stories": 3421,
  "reports": 54,
  "active_today": 2130
}

3ï¸âƒ£ Manage Users
Get all users

GET /api/admin/users?page=1

{
  "data": [
    {
      "id": 1,
      "username": "johndoe",
      "status": "active",
      "verified": false
    }
  ]
}

Ban / Unban User

POST /api/admin/users/{id}/ban

{
  "reason": "Spam activity"
}


Response

{
  "status": "banned"
}

4ï¸âƒ£ Content Moderation
Get reported posts

GET /api/admin/reports/posts

{
  "reports": [
    {
      "post_id": 101,
      "reason": "Inappropriate content",
      "reported_by": 55
    }
  ]
}

Delete post

DELETE /api/admin/posts/{id}

{
  "status": "deleted"
}

5ï¸âƒ£ Platform Controls

POST /api/admin/settings

{
  "registration_enabled": true,
  "max_story_duration": 24
}

ğŸ“¸ STORY APIs (Like Instagram / WhatsApp)

Stories are temporary content (24h), cached heavily, and CDN-served.

6ï¸âƒ£ Create Story

POST /api/stories

{
  "media": "https://cdn.example.com/story.mp4",
  "type": "video",
  "duration": 15
}


Response

{
  "story_id": 901,
  "expires_at": "2025-12-30T12:00:00Z"
}

7ï¸âƒ£ Get Stories Feed

GET /api/stories/feed

{
  "stories": [
    {
      "user": "janedoe",
      "stories": [
        {
          "story_id": 901,
          "media": "https://cdn.example.com/story.mp4"
        }
      ]
    }
  ]
}


ğŸ”¥ Cached in Redis
ğŸ”¥ Only from followed users

8ï¸âƒ£ View Story (Tracking)

POST /api/stories/{id}/view

{
  "viewed": true
}

ğŸ” MATCHING (MUTUAL FOLLOW SYSTEM)

Used for:

Private chat enablement

Profile suggestions

â€œMatchedâ€ users logic

9ï¸âƒ£ Get Mutual Matches

GET /api/matches

{
  "matches": [
    {
      "user_id": 7,
      "username": "alex",
      "matched_at": "2025-12-29T09:00:00Z"
    }
  ]
}

Matching Logic (Backend)
User A follows B
User B follows A
â†’ MATCH CREATED


ğŸ”¥ Stored in matches table
ğŸ”¥ Cached per user

ğŸ”Ÿ Match Status Check

GET /api/users/{id}/match-status

{
  "matched": true
}

ğŸ” OAUTH API HANDLING (VERY IMPORTANT)

Laravel handles OAuth without sessions using API tokens.

Supported:

Google

Facebook

GitHub

Apple

1ï¸âƒ£1ï¸âƒ£ OAuth Redirect (Client Step)

Client redirects user to:

/api/oauth/google/redirect

1ï¸âƒ£2ï¸âƒ£ OAuth Callback (Backend)

GET /api/oauth/google/callback?code=XXXX

Backend Flow

Exchange code â†’ provider token

Fetch user profile

Create or update user

Issue JWT / Sanctum token

Response

{
  "token": "jwt_access_token",
  "user": {
    "id": 55,
    "email": "user@gmail.com"
  }
}


ğŸ”¥ No PHP sessions
ğŸ”¥ Works perfectly behind load balancer

1ï¸âƒ£3ï¸âƒ£ OAuth Mobile / SPA (Token Flow)

For mobile apps:

POST /api/oauth/google/token

{
  "access_token": "google_access_token"
}


Response

{
  "token": "jwt_access_token"
}

ğŸ§  SECURITY & SCALING NOTES

Admin APIs â†’ separate middleware

Stories â†’ auto-expire via scheduled jobs

Matching â†’ indexed & cached

OAuth â†’ stateless token exchange

Redis â†’ sessions, cache, rate limits

CDN â†’ all story media

ğŸ”µ VERIFIED PROFILE (BLUE TICK) SYSTEM

ğŸ“‹ COMPLETE ENDPOINT REFERENCE (10 Total)

User-Side Verification Endpoints (3):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. POST   /api/v1/verification/request        â†’ Submit verification with documents
2. GET    /api/v1/verification/status         â†’ Check current verification status
3. DELETE /api/v1/verification/cancel         â†’ Cancel pending verification

Admin-Side Verification Endpoints (7):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4. GET    /api/v1/admin/verification/pending   â†’ List requests awaiting review
5. GET    /api/v1/admin/verification/approved  â†’ View all approved verifications
6. GET    /api/v1/admin/verification/rejected  â†’ View all rejected requests
7. GET    /api/v1/admin/verification/all       â†’ Complete verification history
8. GET    /api/v1/admin/verification/{id}      â†’ View request details & documents
9. POST   /api/v1/admin/verification/{id}/approve  â†’ Approve & set verified badge
10. POST  /api/v1/admin/verification/{id}/reject   â†’ Reject with reason
ğŸ¯ Verification Types

You can support multiple verification levels:

Type	Meaning
identity	Real person (ID-based)
business	Registered company
creator	Public figure / influencer
system	Manually granted (VIP, staff)
ğŸ“Œ USER-SIDE ENDPOINTS
1ï¸âƒ£ Request Verification

POST /api/verification/request

Request
{
  "type": "identity",
  "full_name": "John Michael Doe",
  "document_type": "passport",
  "document_front": "https://cdn.example.com/id-front.jpg",
  "document_back": "https://cdn.example.com/id-back.jpg",
  "selfie": "https://cdn.example.com/selfie.jpg",
  "note": "Public speaker and tech blogger"
}

Response
{
  "status": "submitted",
  "message": "Verification request submitted successfully"
}


ğŸ”¥ Stored as PENDING
ğŸ”¥ Documents stored securely (private bucket)

2ï¸âƒ£ Get Verification Status

GET /api/verification/status

Response
{
  "verified": false,
  "status": "pending",
  "type": "identity",
  "submitted_at": "2025-12-28T15:20:00Z"
}

3ï¸âƒ£ Cancel Verification Request

DELETE /api/verification/cancel

{
  "status": "cancelled"
}

ğŸ›¡ï¸ ADMIN-SIDE ENDPOINTS (REVIEW & HISTORY)

Base:

/api/admin/verification/*

4ï¸âƒ£ List Pending Requests

GET /api/admin/verification/pending

Query Parameters:
- page (optional, default: 1)
- limit (optional, default: 20)

Response
{
  "status": "success",
  "data": [
    {
      "request_id": 12,
      "user": {
        "id": 55,
        "username": "johndoe"
      },
      "type": "identity",
      "submitted_at": "2025-12-28T15:20:00Z",
      "status": "pending"
    }
  ],
  "pagination": {
    "total": 5,
    "page": 1,
    "limit": 20,
    "pages": 1
  }
}

4ï¸âƒ£ List Approved Verifications (PROCESSED)

GET /api/admin/verification/approved

Query Parameters:
- page (optional, default: 1)
- limit (optional, default: 20)

Response
{
  "status": "success",
  "data": [
    {
      "id": 1,
      "request_id": 1,
      "user": {
        "id": 1,
        "username": "testuser",
        "name": "Test User",
        "email": "test@example.com"
      },
      "type": "identity",
      "submitted_at": "2025-12-30T12:07:56Z",
      "reviewed_at": "2025-12-30T12:09:13Z",
      "status": "approved"
    }
  ],
  "pagination": {
    "total": 1,
    "page": 1,
    "limit": 20,
    "pages": 1
  }
}

4ï¸âƒ£ List Rejected Verifications (PROCESSED)

GET /api/admin/verification/rejected

Query Parameters:
- page (optional, default: 1)
- limit (optional, default: 20)

Response
{
  "status": "success",
  "data": [
    {
      "id": 2,
      "request_id": 2,
      "user": {
        "id": 1,
        "username": "testuser",
        "name": "Test User",
        "email": "test@example.com"
      },
      "type": "business",
      "submitted_at": "2025-12-30T12:09:28Z",
      "reviewed_at": "2025-12-30T12:09:38Z",
      "rejection_reason": "Document not clear enough, please resubmit with higher quality images",
      "status": "rejected"
    }
  ],
  "pagination": {
    "total": 1,
    "page": 1,
    "limit": 20,
    "pages": 1
  }
}

4ï¸âƒ£ View All Verification History

GET /api/admin/verification/all

Query Parameters:
- page (optional, default: 1)
- limit (optional, default: 20)

Response
{
  "status": "success",
  "data": [
    {
      "id": 1,
      "request_id": 1,
      "user": { ... },
      "type": "identity",
      "submitted_at": "2025-12-30T12:07:56Z",
      "reviewed_at": "2025-12-30T12:09:13Z",
      "status": "approved"
    },
    {
      "id": 2,
      "request_id": 2,
      "user": { ... },
      "type": "business",
      "submitted_at": "2025-12-30T12:09:28Z",
      "reviewed_at": "2025-12-30T12:09:38Z",
      "rejection_reason": "...",
      "status": "rejected"
    },
    {
      "id": 3,
      "request_id": 3,
      "user": { ... },
      "type": "creator",
      "submitted_at": "2025-12-30T12:10:00Z",
      "reviewed_at": null,
      "status": "pending"
    }
  ],
  "pagination": {
    "total": 3,
    "page": 1,
    "limit": 20,
    "pages": 1
  }
}

5ï¸âƒ£ View Verification Details

GET /api/admin/verification/{id}

{
  "request_id": 12,
  "documents": {
    "front": "secure-url",
    "back": "secure-url",
    "selfie": "secure-url"
  },
  "note": "Public speaker and tech blogger"
}

6ï¸âƒ£ Approve Verification (Blue Tick)

POST /api/admin/verification/{id}/approve

{
  "badge": "blue",
  "expires_at": null
}

Response
{
  "status": "approved",
  "verified_at": "2025-12-29T12:00:00Z"
}


ğŸ”¥ Sets:

users.verified = true
users.verified_type = identity

7ï¸âƒ£ Reject Verification

POST /api/admin/verification/{id}/reject

{
  "reason": "Document unclear"
}

{
  "status": "rejected"
}

ğŸ§± DATABASE STRUCTURE (IMPORTANT)
users table
verified BOOLEAN DEFAULT false
verified_type ENUM('identity','business','creator','system')
verified_at TIMESTAMP NULL

verification_requests table
id
user_id
type
status ENUM('pending','approved','rejected','cancelled')
document_front
document_back
selfie
note
reviewed_by
reviewed_at
created_at

ğŸ” SECURITY BEST PRACTICES (CRITICAL)

Documents stored in private storage

Signed URLs (temporary access)

Admin access only

Rate-limit verification requests

One active request per user

Audit logs for approvals

ğŸ¨ FRONTEND DISPLAY LOGIC
if user.verified == true
â†’ show blue tick icon ğŸ”µ


For API:

{
  "username": "johndoe",
  "verified": true,
  "verified_type": "identity"
}

âš¡ PERFORMANCE & SCALING

Verification status cached in Redis

Blue tick embedded in profile payload

No extra DB hits for feeds

Works across all load-balanced servers

ğŸ§  OPTIONAL ADVANCED FEATURES

Paid verification (Stripe)

Expiring verification

Auto-verification for large followers

AI document validation (future)

Multiple badge colors (gold, gray)


Core tables: users, posts, comments, likes, follows, matches, stories, messages, notifications, verification_requests, reports, blocks, saved_posts, oauth_accounts, admin_users
Infrastructure Notes
Redis for sessions/cache, CDN for media, queues for background jobs, cron for cleanup tasks.
Conclusion
This master specification is production-ready and suitable for enterprise Laravel deployments.